---
layout: post
title:  "php8、9、10章"
date:   2015-12-21
categories: php
---



# 第八章 错误、异常数量与调试

```
常见的5中错误类型
语法错误
语义错误
逻辑错误
注释错误
运行错误
```

### 语法错误

```
错误级别:
E_ERROR:严重错误，不可恢复，如位置异常、内存不足
E_WARNING:警告，最一般的错误，如函数参数错误
E_PARSE:解析错误，在解析PHP文件时产生，并强制PHP在执行前推出
E_STRICT:这个错误级别是唯一不包含在E_ALL常量中的，主要是为了便于兼容PHP低版本
E_NOTICE:通告表示可能在操作一下未知的变量等，在开发时可开启通告，以保证程序是"通告安全"的，而在正式系统中，应关闭通告。
E_CORE_ERROR:这个内部错误是由于php加载扩展失败而导致的，并且会导致php停止运行并退出
E_COMPILE_ERROR:编译错误是在编译时发生的，这个错误将导致php运行退出
E_COMPILE_WARNING:编译警告用于告诉用户一些不推荐的语法信息
E_USER_ERROR:用户定义的错误将导致php退出执行，它不是来自php本身，而是来自脚本文件中
E_USER_WARNING:脚本使用它来通知一个执行失败，同时PHP也会用E_WARNING通知
E_USER_NOTICE:用户定义的通告用于在脚本中表示可能存在的错误
```

### php对错误处理设置

```
display_errors:是否显示错误信息
err_reporting：如何显示提示信息，默认值为E_ALL&~E_NOTICE,显示除注意信息外的所有提示信息

对于调试模式:
display_errors = On
err_reporting = E_ALL&~E_NOTIC

对于web模式：
display_errors = Off
err_reporting = E_ALL

或者使用error_reporting()函数进行设置。该函数的参数与php.ini文件中的一样
```

```
php显示错误
<?php
$str_1 = "this is a string.";
echo $str_1;
error_reporting(E_ALL);
prinr($str_1);
?>
运行结果：
this is a string.PHP Fatal error:  Call to undefined function prinr() in /usr/local/apache/htdocs/php/mm.php on line 5
```

### 错误处理

1.错误信息的隐藏：error_reporting()函数进行设置
```
除了可以在php.ini中进行设置方法外，还可以直接在程序中进行设置

<?php
error_reporting(0);           //隐藏所有提示信息
$filename = "something.txt";
$handle = fopen($filename, "r");  //打开文本文件
$contents = fread($handle, filesize ($filename));   //读取文本文件内容
print $contents;
fclose($handle);      //关闭文件
?>

可以在语句前增加@符号进行特定行隐藏
<?php
$filename = "something.txt";
$handle = @fopen($filename, "r");     //打开给定的文本文件
$contents = @fread($handle, filesize ($filename));    //读取文件内容
print $contents;    //输出文件内容
fclose($handle);    //关闭文件
?>
运行结果：
PHP Warning:  fclose() expects parameter 1 to be resource, boolean given in /usr/local/apache/htdocs/php/aaaaaa.php on line 6
```

2、错误信息定制
```
在实际应用中，显示所有错误提示信息，将会给服务器带来安全隐患，这时候就需要对php进行定制错误信息
常用使用if语句进行检查错误，并根据结果输出不同信息

<?php
$filename = "something.txt";
if($handle = @fopen($filename, "r")){       //使用if语句判断文件是否存在
  $contents = @fread($handle, filesize ($filename));
  print $contents;
  fclose($handle);
}else{
  echo "文件：" . $filename . "不存在.";
}
?>
运行结果：
文件：something.txt不存在.
```

```
**页面跳转**
header("location:url")

<?php
$filename = "something.txt";
if($handle = @fopen($filename, "r")){       //使用if语句判断文件是否存在
  $contents = @fread($handle, filesize ($filename));
  print $contents;
  fclose($handle);
}else{
  header("location:http://www.baidu.com");
}
?>
运行结果：
跳转到baidu页面
```
